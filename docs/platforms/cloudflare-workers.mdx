---
title: Cloudflare Workers
---

import SetupNextSteps from '/snippets/setup-next-steps.mdx';
import MvpWarning from '/snippets/mvp-warning.mdx';
import RunStudio from '/snippets/run-studio.mdx';

The Cloudflare Workers platform with Durable Objects provides a robust environment for running ActorCore at the edge.

<Note>
  ActorCore relies on features only available in the Workers Paid plan ([more info](https://developers.cloudflare.com/durable-objects/platform/pricing/)).

  To deploy hobby projects with ActorCore for free, try deploying to [Rivet](/platforms/rivet).
</Note>

<MvpWarning />

## Getting Started

### Option 1: Start with Template

Get started with a pre-configured project template:

```sh
npx create-actor@latest -p cloudflare-workers
```

This command will walk you through the rest of the steps.

### Option 2: Start from Scratch

<Steps>
  <Step title="Create a new Cloudflare Workers project">
    Create a new Cloudflare Workers project with Wrangler:
    
    <CodeGroup>
      ```sh npm
      npm create cloudflare@latest -- my-actor-app --type=hello-world --lang=ts --no-deploy
      cd my-actor-app
      ```
      
      ```sh pnpm
      pnpm create cloudflare@latest -- my-actor-app --type=hello-world --lang=ts --no-deploy
      cd my-actor-app
      ```
      
      ```sh yarn
      yarn create cloudflare@latest -- my-actor-app --type=hello-world --lang=ts --no-deploy
      cd my-actor-app
      ```
      
      ```sh bun
      bun create cloudflare@latest -- my-actor-app --type=hello-world --lang=ts --no-deploy
      cd my-actor-app
      ```
    </CodeGroup>

    Follow the prompts to set up a basic Worker project.
  </Step>

  <Step title="Install ActorCore">
    Install ActorCore and the Cloudflare Workers platform package:
    
    <CodeGroup>
      ```sh npm
      npm install actor-core @actor-core/cloudflare-workers
      ```
      
      ```sh pnpm
      pnpm add actor-core @actor-core/cloudflare-workers
      ```
      
      ```sh yarn
      yarn add actor-core @actor-core/cloudflare-workers
      ```
      
      ```sh bun
      bun add actor-core @actor-core/cloudflare-workers
      ```
    </CodeGroup>
  </Step>

  <Step title="Define your actor">
    Create a new file `src/app.ts` with your actor definition:

    ```typescript src/app.ts
    import { actor, setup } from "actor-core";

    // Create actor
    const counter = actor({
      state: { count: 0 },
      actions: {
        increment: (c, x: number) => {
          c.state.count += x;
          c.broadcast("newCount", c.state.count);
          return c.state.count;
        }
      }
    });

    // Create the application
    export const app = setup({
      actors: { counter },
      cors: { origin: "*" } // Configure CORS for your production domains in production
    });

    // Export app type for client usage
    export type App = typeof app;
    ```
  </Step>

  <Step title="Create your server">
    Update your `src/index.ts` file to use ActorCore with Cloudflare Workers:

    ```typescript src/index.ts
    import { createHandler } from "@actor-core/cloudflare-workers";
    import { app } from "./app";

    // Create handlers for Cloudflare Workers
    const { handler, ActorHandler } = createHandler(app);

    // Export the handlers for Cloudflare
    export { handler as default, ActorHandler };
    ```

    Then update your `wrangler.jsonc` configuration:

    ```json wrangler.jsonc
    {
      "$schema": "node_modules/wrangler/config-schema.json",
      "name": "my-actor-app",
      "main": "src/index.ts",
      "compatibility_date": "2025-04-04",
      "observability": {
        "enabled": true
      },
      "migrations": [
        {
          "tag": "v1",
          "new_classes": ["ActorHandler"]
        }
      ],
      "durable_objects": {
        "bindings": [
          {
            "name": "ACTOR_DO",
            "class_name": "ActorHandler"
          }
        ]
      },
      "kv_namespaces": [
        {
          "binding": "ACTOR_KV",
          "id": "FILL_ME_IN_WHEN_YOU_DEPLOY"
        }
      ]
    }
    ```
  </Step>

  <Step title="Start your development server">
	<RunStudio />

	<Info>
		**Need to run the server directly?**

		Start the Wrangler development server:

		```sh
		npx wrangler dev
		```

		Your server will be running at http://localhost:8787
	</Info>
  </Step>

  <Step title="Connect to your actor">
    Create a file named `client.ts` in your project root to connect to your actor:

    ```typescript client.ts
    import { createClient } from "actor-core/client";
    import type { App } from "./src/app";

    async function main() {
      const client = createClient<App>("http://localhost:8787");

      const counter = await client.counter.get();

      // Subscribe to events
      counter.on("newCount", (count: number) => console.log("Event:", count));

      // Call an action
      const out = await counter.increment(5);
      console.log("Action:", out);

      // Clean up
      await counter.dispose();
    }

    main().catch(console.error);
    ```

    Run the client to test your actor:

    ```sh
    npx tsx client.ts
    ```

    You should see output like:
    ```
    Event: 5
    Action: 5
    ```

    Run it again to see the state update.
  </Step>

  <Step title="Deploy to production">
    1. Create a KV namespace for your actors:

    ```sh
    npx wrangler kv:namespace create ACTOR_KV
    ```

    2. Update your `wrangler.jsonc` with the KV namespace ID from the output:

    ```jsonc
    "kv_namespaces": [
      {
        "binding": "ACTOR_KV",
        "id": "your-namespace-id-here"  // Replace with your actual ID
      }
    ]
    ```

    3. Deploy your project:

    ```sh
    npx wrangler deploy
    ```

    4. Update your client to connect to your deployed Workers endpoint:

    ```typescript
    const client = createClient<App>("https://my-actor-app.your-subdomain.workers.dev");
    ```
  </Step>
</Steps>

### Option 3: Integration with Existing Projects

If you already have an existing application and want to mount ActorCore on a subpath, see our [Hono integration guide](/integrations/hono). Remember to specify the same path in `config.basePath` as where you mount the router.

## CORS Configuration

For security reasons, you should configure proper CORS settings in production. In the example above, we used `cors: { origin: "*" }` which allows requests from any domain.

For production deployments, specify the exact domains that should be allowed to connect to your actors. Learn more in the [CORS documentation](/concepts/cors).

## Accessing Cloudflare Context And Bindings

You can access Cloudflare-specific features like the [DurableObjectState](https://developers.cloudflare.com/durable-objects/api/state/) and environment bindings from your actor:

```typescript
import { actor } from "actor-core";

const myActor = actor({
  // Load Cloudflare-specific variables
  createVars: (c, cloudflare) => ({
    ctx: cloudflare.ctx,
    env: cloudflare.env,
  }),
  actions: {
    foo: async (c) => {
      // Access DurableObjectState
      await c.vars.ctx.storage.get("foo");

      // Access bindings
      await c.vars.env.MY_BUCKET.put(key, "foo");
    },
  }
});
```

## Available Regions

See available regions [here](https://developers.cloudflare.com/durable-objects/reference/data-location/#supported-locations-1).

Cloudflare does not guarantee your code will run in the requested region.

## Next Steps

<SetupNextSteps />
